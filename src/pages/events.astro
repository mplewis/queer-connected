---
import { EventsView } from '../components/EventsView';
import { DISCORD_GUILD_ID } from '../config/env';
import Layout from '../layouts/Layout.astro';
import { getScheduledEventsForGuild, type PublicEvent } from '../logic/discord';

const allEvents = await getScheduledEventsForGuild(DISCORD_GUILD_ID, { recurrences: 10 }); // FIXME: use 30 before, 90 after
const events: PublicEvent[] = allEvents.map(({ guildID, ...rest }) => rest);
---

<Layout
  title="Events"
  description="Community events calendar - join us for upcoming gatherings and activities"
>
  <EventsView events={events} client:load />
</Layout>
